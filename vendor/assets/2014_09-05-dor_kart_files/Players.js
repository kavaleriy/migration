window.define=window.define||function(name,deps,callback){(callback||deps||name)()};
(function(jQuery){var $=jQuery;define("{patron.v2.utils}players/patron.Utils.players.Base",["{jQuery}jquery"],function($){$.preloadTpl("players.iframe",'<iframe width="<%= width %>" height="<%= height %>" src="<%= baseUrl %><%= id %>?<% for(var key in queryParams) { %><%= key %>=<%= queryParams[key] %><% } %>" webkitAllowFullScreen mozallowfullscreen allowfullscreen></iframe>');$.preloadTpl("players.object",'<span id="<%= id %>"/>');function render(type,data){return $.tpl("players."+type,data)}function createSWF(o,
done){swfobject.embedSWF(o.src+"?"+$.param(o.queryParams),o.id,o.width,o.height,o.allowVersion,null,o.vars,o.params,o.attrs,done)}function getId(links,uri){var rgs=Array.filter(links,function(regex){return regex.test(uri)});if(rgs.length===0)return null;return uri.match(rgs[0])[1]}return{render:render,getId:getId,createSWF:createSWF}});define("{patron.v2.utils}players/patron.Utils.players.YouTube",["{patron.v2.utils}players/patron.Utils.players.Base"],function(base){var patterns=[/^http:\/\/(?:www\.)?youtube\.(?:com|ru)\/watch\?v=([^&?]+)/,
/^http:\/\/(?:www\.)?youtu\.be\/([^\?]+)/,/^http:\/\/(?:www\.)?youtube\.(?:com|ru)\/user\/.*?p\/u\/\d+\/([^&?]+)/];var moduleOptions={baseUrl:"//www.youtube.com/embed/",queryParams:{version:"3",autoplay:"1"}};function create(uri,container,defaults,completed){var id=base.getId(patterns,uri),options=$.extend(defaults,moduleOptions,{id:id});$.ajax({url:"//gdata.youtube.com/feeds/api/videos/"+id,dataType:"jsonp",data:{"alt":"json-in-script"},success:function(data){container.find(".js-name").text(data&&
data.entry&&data.entry.title&&data.entry.title.$t?data.entry.title.$t:"")}});container.find(".js-player").innerHTML(base.render("iframe",options));completed()}function test(uri){return base.getId(patterns,uri)!==null}return{test:test,create:create}});define("{patron.v2.utils}players/patron.Utils.players.RuTube",["{patron.v2.utils}players/patron.Utils.players.Base"],function(base){var patterns=[/^http:\/\/(?:www\.)?rutube\.ru\/tracks\/\d+\.html\?v=([^&?]+)/,/^http:\/\/(?:www\.)?rutube\.ru\/video\/(.*)(\/)?/];
var moduleOptions={baseUrl:"//rutube.ru/play/embed/",queryParams:{version:"3",autoplay:"1"}};function create(uri,container,defaults,completed){container.find(".js-player").innerHTML(base.render("iframe",$.extend(defaults,moduleOptions,{id:base.getId(patterns,uri)})));completed()}function test(uri){return base.getId(patterns,uri)!==null}return{test:test,create:create}});define("{patron.v2.utils}players/patron.Utils.players.Vimeo",["{patron.v2.utils}players/patron.Utils.players.Base"],function(base){var patterns=
[/^http:\/\/(?:www\.)?vimeo\.com\/.*(\d+)/];var moduleOptions={baseUrl:"//player.vimeo.com/video/",queryParams:{version:"3",autoplay:"1"}};function create(uri,container,defaults,completed){var id=base.getId(patterns,uri),options=$.extend(defaults,moduleOptions,{id:id});$.ajax({url:"//vimeo.com/api/v2/video/"+id+".json",dataType:"jsonp",success:function(data){container.find(".js-name").text(data&&data.length>0?data[0].title:"")}});container.find(".js-player").innerHTML(base.render("iframe",options));
completed()}function test(uri){return base.getId(patterns,uri)!==null}return{test:test,create:create}});define("{patron.v2.utils}players/patron.Utils.players.MailRu",["{patron.v2.utils}players/patron.Utils.players.Base"],function(base){var patterns=[/^http:\/\/my\.mail\.ru\/([\w\/./]+)\.html/,/^http:\/\/video\.mail\.ru\/([\w\/./]+)\.html/];var moduleOptions={baseUrl:"//api.video.mail.ru/videos/embed/",src:"//my1.imgsmail.ru/r/video2/uvpv3.swf",queryParams:{}};function create(uri,container,defaults,
completed){var id=base.getId(patterns,uri),options=$.extend(defaults,moduleOptions,{id:id,vars:{movieSrc:id.replace("/video/","/")}});container.find(".js-player").innerHTML(base.render("object",options));base.createSWF(options,completed)}function test(uri){return base.getId(patterns,uri)!==null}return{test:test,create:create}});define("{patron.v2.utils}players/patron.Utils.players.Ivi",["{patron.v2.utils}players/patron.Utils.players.Base"],function(base){var patterns=[/ivi.ru\/watch.*\/(\d+)/];var moduleOptions=
{src:"//www.ivi.ru/video/player",baseUrl:"//www.ivi.ru/external/stub/?videoId="};function create(uri,container,defaults,completed){var id=base.getId(patterns,uri),options=$.extend(defaults,moduleOptions,{id:id,queryParams:{videoId:id}});container.find(".js-player").innerHTML(base.render("object",options));base.createSWF(options,completed)}function test(uri){return patron.EnableIVIPlayerInLetter&&base.getId(patterns,uri)!==null}return{test:test,create:create}});jsLoader.use(["{patron.v2.utils}players/patron.Utils.players.YouTube",
"{patron.v2.utils}players/patron.Utils.players.RuTube","{patron.v2.utils}players/patron.Utils.players.Vimeo","{patron.v2.utils}players/patron.Utils.players.MailRu","{patron.v2.utils}players/patron.Utils.players.Ivi"],function(){jsLoader.loaded("{patron.build}Players",Array.prototype.slice.call(arguments))});window.$=window.jQuery=jQuery})(window.patron&&patron.jQuery||window.jQuery);
